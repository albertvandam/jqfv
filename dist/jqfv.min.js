/**
 * MIT License
 *
 * Copyright (c) 2017 Albert van Dam <albert@vandam.io>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

(function() {'use strict';var l="function"==typeof Object.defineProperties?Object.defineProperty:function(f,n,k){if(k.get||k.set)throw new TypeError("ES3 does not support getters and setters.");f!=Array.prototype&&f!=Object.prototype&&(f[n]=k.value)},G="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;
function M(f,n){if(n){var k=G;f=f.split(".");for(var g=0;g<f.length-1;g++){var w=f[g];w in k||(k[w]={});k=k[w]}f=f[f.length-1];g=k[f];n=n(g);n!=g&&null!=n&&l(k,f,{configurable:!0,writable:!0,value:n})}}
M("String.prototype.startsWith",function(f){return f?f:function(f,k){var g;if(null==this)throw new TypeError("The 'this' value for String.prototype.startsWith must not be null or undefined");if(f instanceof RegExp)throw new TypeError("First argument to String.prototype.startsWith must not be a regular expression");g=this+"";f+="";var n=g.length,u=f.length;k=Math.max(0,Math.min(k|0,g.length));for(var t=0;t<u&&k<n;)if(g[k++]!=f[t++])return!1;return t>=u}});
M("Array.prototype.find",function(f){return f?f:function(f,k){a:{var g=this;g instanceof String&&(g=String(g));for(var n=g.length,u=0;u<n;u++){var t=g[u];if(f.call(k,t,u,g)){f=t;break a}}f=void 0}return f}});
var N={ZA:{description:"South Africa",sep:[4,8],pattern:"^0[0-9]{2}-[0-9]{3}-[0-9]{4}$",prefix:"+27",length:12,startsWith:"0"},SWZ:{description:"Swaziland",sep:[5],pattern:"^[27][0-9]{3}-[0-9]{4}$",prefix:"+268",length:9},LSO:{description:"Lesotho",sep:[5],pattern:"^[0-9]{4}-[0-9]{4}$",prefix:"+266",length:9},BWA:{description:"Botswana",sep:[3],pattern:"^[0-9]{2,3}-[0-9]{5}$",prefix:"+267",length:9},ZMB:{description:"Zambia",sep:[4],pattern:"^[0-9]{3}-[0-9]{6}",prefix:"+260",length:10},NAM:{description:"Namibia",
sep:[4,8],pattern:"^[0-9]{3}-[0-9]{3}-[0-9]{3}$",prefix:"+264",length:11}};window.jqfv=new function(){function f(){$("input, textarea").each(function(){var a=$(this);if("undefined"===typeof a.attr("data-valid-chars")){var b=a.attr("pattern");if("undefined"!==typeof b){var c=b.indexOf("[");-1!==c&&(b=b.substr(c,b.length),b=b.substr(0,b.indexOf("]")+1));r(a,"data-valid-chars",b)}}})}function n(a){y={};a.each(function(){if(C){var a=$(this),c=a.closest("form");if(c.length){var e=!0,c=c.attr("data-must-change");"undefined"!==typeof c&&"no"===c&&(e=!1);e&&(e=a.attr("id"),c=a.val(),
"checkbox"!==a.attr("type")||a.prop("checked")||(c=""),y[e]=c)}}})}function k(a){a.on("keyup input paste click",function(){var a=$(this);w(a,!0,!1)})}function g(){$("select:not(.jqfv-skip)").on("click change",function(){var a=$(this);w(a,!0,!1)})}function w(a,b,c){var e=a.attr("id").toString(),d=a.val().toString(),m=a.attr("data-upper");if("undefined"===typeof m?0:"Y"===m)d=d.toUpperCase(),a.val(d);"checkbox"!==a.attr("type")||a.prop("checked")||(d="");m=d;y.hasOwnProperty(e)?m!==y[e]?a.hasClass("jqfv-changed")||
a.addClass("jqfv-changed"):a.hasClass("jqfv-changed")&&a.removeClass("jqfv-changed"):a.hasClass("jqfv-changed")||a.addClass("jqfv-changed");var m=d,h=a.attr("data-valid-chars");"undefined"!==typeof h&&(h=m.match(new RegExp("["+h+"]*","g")),h=null===h?"":h.join(""),m!==h&&(m=h,a.val(m)),"number"!==a.attr("type")||m.length||a.val(""));d=$.trim(d);d.length&&a.removeClass("jqfv-empty");"tel"===a.attr("type")&&"undefined"===typeof a.attr("data-nomask")&&(d=H(a,d));if(a.get(0).willValidate){a.get(0).setCustomValidity("");
if(d.length){var m=a.attr("minlength"),m="undefined"===typeof m?0:m,h=a.attr("maxlength"),h="undefined"===typeof h?0:h,f=a.attr("required"),f="undefined"!==typeof f,g=a.val(),g="undefined"===typeof g?"":$.trim(g),p=g.length;p||f||(m=0);0!==m&&p<m&&a.get(0).setCustomValidity("Minimum length");0!==h&&h<p&&a.val(g.slice(0,h));if(-1!==D.indexOf(e)){for(var g=a.val().trim(),p=g.length-1,m=g.substr(p,p),h=0,f="",k=0;p>k;k+=2)h+=parseInt(g.substring(k,k+1),10),f+=g.substring(k+1,k+2);f=(2*parseInt(f,10)).toString();
g=f.length;for(p=0;p<g;p++)h+=parseInt(f.substring(p,p+1),10);h=h.toString();h=10-parseInt(h.substring(h.length-1,h.length),10);h=h.toString();"10"===h&&(h="0");h!==m&&a.get(0).setCustomValidity("Luhn check failed")}}"tel"===a.attr("type")&&"undefined"===typeof a.attr("data-nomask")&&(d.replace(/[0-]/g,"").length&&"00"!==d.substr(0,2)||a.get(0).setCustomValidity("Phone number cannot be 000-000-0000"));if(x.hasOwnProperty(e))x[e](a);a.get(0).validity.valid?(q.a(e,!1),t(a,!0),"tel"===a.attr("type")&&
"undefined"===typeof a.attr("data-nomask")&&"undefined"!==typeof a.attr("data-country-picker")&&$("#"+e+"-country").removeClass("jqfv-tel-incorrect")):(c&&a.hasClass("jqfv-empty")||(q.a(e,!0),t(a,!1)),"tel"===a.attr("type")&&"undefined"===typeof a.attr("data-nomask")&&"undefined"!==typeof a.attr("data-country-picker")&&$("#"+e+"-country").addClass("jqfv-tel-incorrect"))}"undefined"===typeof a.attr("disabled")&&v[e]&&(u(e),a.get(0).setCustomValidity("Backend validation busy"),a.hasClass("jqfv-async")||
a.addClass("jqfv-async"));b&&A(a.closest("form"))}function u(a){B.hasOwnProperty(a)&&window.clearTimeout(B[a]);B[a]=window.setTimeout(function(){window.clearTimeout(B[a]);I(a,!1)},1E3)}function t(a,b){a=a.attr("data-enable");if("undefined"!==typeof a){a=$("#"+a);var c=!0;b?(a.removeAttr("disabled"),c=a.get(0).validity.valid):a.attr("disabled","disabled");c&&t(a,b)}}function O(a){a.on("blur",function(){J($(this),!0,!1)})}function J(a,b,c){var e=a.val().toString(),d=a.attr("id").toString(),f="undefined"===
typeof a.attr("disabled");if(x.hasOwnProperty(d))x[d](a);f&&a.get(0).validity.valid&&null!==e&&0!==e.length&&v.hasOwnProperty(d)&&I(d,c,a,e);if(E.hasOwnProperty(d))E[d](a);b&&A(a.closest("form"))}function I(a,b,c,e){var d="undefined"===typeof c?$("#"+a):c,f="undefined"===typeof e?d.val().toString():e;if($.trim(f).length){P(a);c=v[a].url;e=v[a].hasOwnProperty("params")?v[a].params:"";e=e.replace("{VAL}",f);c=c.replace("{VAL}",f);var f=!1,h=d.attr("data-sup");if("undefined"!==typeof h)for(var g=h.split(";"),
k=0;k<g.length;k++){var p=g[k],n=$("#"+p).val().trim();n.length||(f=!0);c=c.replace("{"+p+"}",n);e=e.replace("{"+p+"}",n)}v[a].hasOwnProperty("empty")&&!v[a].empty&&f||$.ajax({noLoader:!0,url:c,data:{params:e},success:function(c){d.removeClass("jqfv-async");if(c.ok){if(d.get(0).setCustomValidity(""),q.a(a,!1),c=d.attr("data-sup"),"undefined"!==typeof h){c=c.split(";");for(var e=0;e<c.length;e++){var f=$("#"+g[e]);f.removeClass("jqfv-async");f.get(0).setCustomValidity("")}}}else b&&d.hasClass("jqfv-empty")||
(d.get(0).setCustomValidity(c.message),z.hasOwnProperty(a)||(z[a]=$('.jqfv-error[data-for="'+a+'"]').text()),q.b(a,c.message),q.a(a,!0));A(d.closest("form"))}})}}function A(a){var b=0===a.find("input:invalid, textarea:invalid, select:invalid").length,c=0!==a.find(".jqfv-changed").length,e=0===a.find(".jqfv-async").length;c&&e&&b?K(a,!0):K(a,!1)}function Q(a){a.on("focus",function(){var a=$(this),c=a.attr("id").toString();"undefined"!==typeof a.attr("data-error-on-focus")&&q.a(c,!0);if(F.hasOwnProperty(c))F[c](a)})}
function P(a){z.hasOwnProperty(a)&&q.b(a,z[a])}function K(a,b){a=a.find("button");b?a.removeAttr("disabled"):a.attr("disabled","disabled")}function R(){$('input[type="tel"]').each(function(){var a=$(this);r(a,"data-valid-chars","0-9-");if("undefined"===typeof a.attr("data-nomask"))if("undefined"===typeof a.attr("data-country-picker"))r(a,"pattern","^0[0-9]{2}-[0-9]{3}-[0-9]{4}$"),r(a,"minlength",12),r(a,"maxlength",12);else{var b=a.attr("data-country");"undefined"!==typeof b&&b.length?b=b.toString():
(a.attr("data-country","ZA"),b="ZA");var c=N.hasOwnProperty(b)?N[b].pattern:"^0[0-9]{2}-[0-9]{3}-[0-9]{4}$";r(a,"pattern",c);c=N.hasOwnProperty(b)?N[b].length:12;r(a,"minlength",c);r(a,"maxlength",c);a.addClass("phone-number");c=a.attr("id");if($("#"+c+"-country").length){var e=$("#"+c+"-flag"),d;for(d in N)N.hasOwnProperty(d)&&(d===b?e.addClass("flag-"+d):e.removeClass("flag-"+d));$("#"+c+"-country").val(b)}else for(e in d='<select name="'+c+'-country" id="'+c+'-country" '+('data-for="'+c+'" ')+
'class="phone-country-picker" required></select>',a.before(d),a.after('<div id="'+c+'-flag" class="phone-flag flag flag-'+b+'"></div><span class="clearfix"></span>'),a=$("#"+c+"-country"),N)N.hasOwnProperty(e)&&(d='<option value="'+e+'"'+(b===e?" selected":"")+">",d+=N[e].prefix,d+="</option>",a.append(d));x[c+"-country"]=function(a){var b=a.val();a=a.attr("data-for");var c=$("#"+a);if(N.hasOwnProperty(b)){c.attr("pattern",N[b].pattern);c.attr("data-country",b);c.attr("minlength",N[b].length);c.attr("maxlength",
N[b].length);var d=c.val(),d=d.replace(/-/g,"");H(c,d)}a=$("#"+a+"-flag");for(var e in N)N.hasOwnProperty(e)&&(e===b?a.addClass("flag-"+e):a.removeClass("flag-"+e))}}})}function H(a,b){var c=a.attr("data-country"),c="undefined"===typeof c?"ZA":c;if(N[c].hasOwnProperty("startsWith")){var e=N[c].startsWith;0!==e.length&&e!==b.charAt(0)&&1<b.length&&(b=e+b)}e=N[c].sep;if(0!==e.length&&b.length<e[e.length-1]&&-1!==e.indexOf(b.length)){var d=b.length-1,f=b.substr(d,d);"-"!==f&&(b=b.substr(0,d)+"-"+f,a.val(b))}for(d=
0;d<e.length;d++)e[d]<b.length&&"-"!==b.substr(e[d]-1,1)&&(b=b.substr(0,e[d]-1)+"-"+b.substr(e[d]-1,b.length),a.val(b));c=N[c].length;b.length>c&&(b=b.substr(0,c),a.val(b));return b}function S(){$('input[type="email"]').each(function(){var a=$(this);r(a,"pattern","^[A-Za-z0-9._%+-]{1,64}@[A-Za-z0-9.-]+.[A-Za-z]{2,4}$");r(a,"data-valid-chars","a-zA-Z0-9._%+-@")})}function T(){$('input[type="number"]').each(function(){var a=$(this),b=a.attr("step"),b="undefined"===typeof b?"1":b,c=(b=parseInt(b,10).toString()!==
b)?"0-9.":"0-9";r(a,"pattern",b?"^[0-9]*(.[0-9]{1,2}){0,1}$":"^[0-9]*$");r(a,"data-valid-chars",c)})}function r(a,b,c){var e=a.attr(b);("undefined"===typeof e?0:e)||a.attr(b,c)}var q=this,v={},D=[],y={},x={},E={},F={},L=!0,z={},C=!0,B={};this.b=function(a,b){$('.jqfv-error[data-for="'+a+'"]').html(b)};this.a=function(a,b,c){if(L){var e=$("#"+a),d=$('.jqfv-error[data-for="'+a+'"]');d.length||(e.after('<span class="jqfv-error" data-for="'+a+'"></span>'),d=$('.jqfv-error[data-for="'+a+'"]'));d.length&&
("undefined"!==typeof c?d.html(c):d.html().trim().length||(a=e.attr("data-hint"),"undefined"!==typeof a&&d.html(a.toString())),b&&!d.is(":visible")?d.fadeIn(600):!b&&d.is(":visible")&&d.fadeOut(600))}};this.g=function(){$('input[value=""]:not(.jqfv-skip), input:not([value]):not(.jqfv-skip), textarea[value=""]:not(.jqfv-skip), textarea:not(.jqfv-skip):not([value]), select[value=""]:not(.jqfv-skip), select:not(.jqfv-skip):not([value])').addClass("jqfv-empty");T();S();R();f();var a=$("input:not(.jqfv-skip), textarea:not(.jqfv-skip), select:not(.jqfv-skip)");
a.off("keyup input paste blur focus click change");O(a);Q(a);n(a);k(a);g()};this.f=function(a,b){b="boolean"===typeof b?b:!1;a=$("#"+a);if(a.length){for(var c=a.get(0),e=c.length,d=0;d<e;d++)w($(c[d]),!1,b),J($(c[d]),!1,b);A(a)}};this.c=function(){C=!0;v={};D=[];y={};x={};z={}};this.h=function(a){q.c();a&&(a.hasOwnProperty("async")&&null!==a.async&&(v=a.async),a.hasOwnProperty("luhn")&&null!==a.luhn&&(D=a.luhn),a.hasOwnProperty("custom")&&null!==a.custom&&(x=a.custom),a.hasOwnProperty("blur")&&null!==
a.blur&&(E=a.blur),a.hasOwnProperty("focus")&&null!==a.focus&&(F=a.focus),a.hasOwnProperty("displayErrors")&&null!==a.displayErrors&&(L=a.displayErrors),a.hasOwnProperty("requireChange")&&null!==a.requireChange&&(C=!0===a.requireChange))};this.initialise=q.g;this.setOptions=q.h;this.resetOptions=q.c;this.checkForm=q.f;this.setErrorMessage=q.b;this.toggleErrorDisplay=q.a};}).call(window);
